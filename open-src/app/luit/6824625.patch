--- sys.h	Sat Nov  4 05:58:45 2006
+++ sys.h	Fri Apr  3 09:29:56 2009
@@ -28,6 +28,7 @@
 int copyTermios(int sfd, int dfd);
 int saveTermios(void);
 int restoreTermios(void);
+int restoreTermios_1(int fd, int opt);
 int setRawTermios(void);
 char *my_basename(char *path);
 int allocatePty(int *pty_return, char **line_return);
--- sys.c	Tue Jan 29 12:01:42 2008
+++ sys.c	Fri Apr  3 09:30:22 2009
@@ -21,6 +21,7 @@
 */
 /* $XFree86: xc/programs/luit/sys.c,v 1.9 2003/08/17 20:39:58 dawes Exp $ */
 
+#include <X11/Xosdefs.h>
 #include <stdlib.h>
 #include <string.h>
 #include <stdio.h>
@@ -249,6 +250,14 @@
     return tcsetattr(0, TCSAFLUSH, &saved_tio);
 }
 
+int
+restoreTermios_1(int fd, int opt)
+{
+    if(!saved_tio_valid)
+        return -1;
+    return tcsetattr(fd, opt, &saved_tio);
+}
+
 int
 setRawTermios(void)
 {
--- luit.c	Tue Jan 29 12:01:42 2008
+++ luit.c	Fri Apr  3 09:33:17 2009
@@ -22,6 +22,7 @@
 /* $XFree86: xc/programs/luit/luit.c,v 1.9 2002/10/17 01:06:09 dawes Exp $ */
 
 #include <stdio.h>
+#include <X11/Xosdefs.h>
 #include <stdlib.h>
 #include <string.h>
 #include <locale.h>
@@ -33,6 +34,7 @@
 #include <stdarg.h>
 #include <sys/ioctl.h>
 #include <signal.h>
+#include <termios.h>
 
 #ifdef SVR4
 #include <stropts.h>
@@ -473,9 +475,11 @@
 #endif
     installHandler(SIGCHLD, sigchldHandler);
 
+#ifndef sun
     rc = copyTermios(0, pty);
     if(rc < 0)
         FatalError("Couldn't copy terminal settings\n");
+#endif
 
     rc = setRawTermios();
     if(rc < 0)
@@ -536,7 +540,11 @@
         kill(getppid(), SIGABRT);
         exit(1);
     }
-    
+
+#ifdef sun    
+    restoreTermios_1(tty, TCSAFLUSH);
+#endif
+
     if(tty != 0)
         dup2(tty, 0);
     if(tty != 1)
