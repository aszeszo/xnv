diff -Nurp -x '*~' -x '*.orig' mi/micmap.c mi/micmap.c
--- mi/micmap.c	2010-06-10 07:07:55.000000000 -0700
+++ mi/micmap.c	2010-09-03 16:45:35.359696561 -0700
@@ -494,6 +494,11 @@ maskShift (Pixel p)
  * the set which can be used with this version of cfb.
  */
 
+#if defined(__sparc__) || defined(__sparc)
+_X_EXPORT miInitVisualsProcPtr miInitVisualsProc = NULL;
+#endif /* __sparc__ */
+
+
 Bool
 miInitVisuals(VisualPtr *visualp, DepthPtr *depthp, int *nvisualp,
 		int *ndepthp, int *rootDepthp, VisualID *defaultVisp,
@@ -513,6 +518,13 @@ miInitVisuals(VisualPtr *visualp, DepthP
     int		*preferredCVCs, *prefp;
     int		first_depth;
 
+#if defined(__sparc__) || defined(__sparc)
+    if (miInitVisualsProc) {
+       return (miInitVisualsProc(visualp, depthp, nvisualp, ndepthp,
+               rootDepthp, defaultVisp, sizes, bitsPerRGB, preferredVis));
+    }
+#endif /* __sparc__ */
+
     /* none specified, we'll guess from pixmap formats */
     if (!miVisuals) 
     {
